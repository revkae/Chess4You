@startuml Integration-Test-Call-Graph

!define TEST_COLOR #E8F5E9
!define MOCK_COLOR #FFF3E0
!define REAL_COLOR #E3F2FD
!define FRAMEWORK_COLOR #FCE4EC

title Integration Test Call-Graph\nPairWiseIntegrationTest Structure

skinparam classBackgroundColor TEST_COLOR
skinparam packageBackgroundColor #FFFFFF
skinparam arrowColor #333333

' Test Framework
package "JUnit 5 + Mockito Framework" <<Rectangle>> FRAMEWORK_COLOR {
  class JUnit5 <<framework>> {
    @Test
    @BeforeEach
    @AfterEach
    @DisplayName
    @Order
  }

  class MockitoExtension <<framework>> {
    @Mock
    @ExtendWith
    when()
    verify()
    lenient()
  }
}

' Main Test Class
package "Test Suite" <<Rectangle>> TEST_COLOR {
  class PairWiseIntegrationTest <<test>> {
    - mockWindow: Window
    - mockCamera: Camera
    - mockRenderer: Renderer
    - mockBoardManager: BoardManager
    - mockPieceManager: PieceManager
    - mockQuad: Quad
    - mockTexture: Texture
    - mockBoard: List<Quad>
    ==
    + setUp()
    + tearDown()
    --
    + testGameManagerBoardManagerIntegration()
    + testPieceManagerBoardManagerTileValidation()
    + testPieceManagerPieceCollection()
    + testBoardManagerEdgeDistanceCalculations()
    + testPieceManagerColorFiltering()
    + testPieceManagerAllyDetection()
    + testPieceManagerKingRetrieval()
    + testPieceManagerRookRetrieval()
    + testPieceManagerAddPieceTypes()
    + testPieceManagerRemovePiece()
    + testTurnChangeTriggersCheckCalculation()
    + testPieceColorsEnumOperations()
    + testPieceDirectionsEnumOperations()
    + testPieceClassIdentification()
    + testBoardTileToCoordinateConversion()
    + testBoardValidateTileBoundaries()
    + testRendererBoardManagerIntegration()
    + testRendererPieceManagerIntegration()
    + testPieceMoveValidationWithEdgeCalculations()
    + testCompleteGameFlowIntegration()
  }
}

' Mock Objects
package "Mock Objects (Mockito)" <<Rectangle>> MOCK_COLOR {
  class "mockBoardManager" <<mock>> {
    + getBoard()
    + getTileCountToEdge()
    + isValidTileNum()
    + onUpdate()
    + onRender()
  }

  class "mockPieceManager" <<mock>> {
    + getPieces()
    + getPiecesByColor()
    + getKingByColor()
    + getRookByColor()
    + hasAlly()
    + hasEnemy()
    + isEnemy()
    + addPawn()
    + addKnight()
    + addBishop()
    + addQueen()
    + addKing()
    + addRook()
    + removePiece()
    + changeTurn()
    + onUpdate()
    + onRender()
  }

  class "mockRenderer" <<mock>> {
    + texturedDraw()
    + onRender()
  }

  class "mockWindow" <<mock>> {
    + getWindow()
  }

  class "mockCamera" <<mock>> {
    + getOrtho()
    + getView()
  }

  class "mockQuad" <<mock>> {
    + getTransform()
    + getCollision()
  }

  class "mockTexture" <<mock>> {
    + load()
  }

  class "mockPiece" <<mock>> {
    + data: PieceData
    + moves: Queue<Integer>
    + preys: Queue<Piece>
  }
}

' Real Classes Being Tested
package "Classes Under Test" <<Rectangle>> REAL_COLOR {
  class BoardManager <<real>> {
    {static} + isValidTileNum(int)
    + getBoard()
    + getTileCountToEdge()
  }

  class PieceManager <<real>> {
    + getPieces()
    + getPiecesByColor()
    + getKingByColor()
    + hasAlly()
    + hasEnemy()
  }

  class GameManager <<real>> {
    + getBoardManager()
    + getPieceManager()
    + getRenderer()
  }

  enum PieceColors <<real>> {
    WHITE
    BLACK
    + changeTurn()
    + getOpposite()
    + equals()
  }

  enum PieceDirections <<real>> {
    NORTH, SOUTH
    EAST, WEST
    NORTH_EAST, NORTH_WEST
    SOUTH_EAST, SOUTH_WEST
    + getValue()
    + isDiagonal()
  }

  enum PieceClass <<real>> {
    KING, QUEEN
    ROOK, BISHOP
    KNIGHT, PAWN
    + getValue()
    + isInstance()
  }
}

' Relationships - Test uses JUnit & Mockito
PairWiseIntegrationTest ..> JUnit5 : <<uses>>
PairWiseIntegrationTest ..> MockitoExtension : <<uses>>

' Test creates/uses Mocks
PairWiseIntegrationTest *-- "mockBoardManager" : creates
PairWiseIntegrationTest *-- "mockPieceManager" : creates
PairWiseIntegrationTest *-- "mockRenderer" : creates
PairWiseIntegrationTest *-- "mockWindow" : creates
PairWiseIntegrationTest *-- "mockCamera" : creates
PairWiseIntegrationTest *-- "mockQuad" : creates
PairWiseIntegrationTest *-- "mockTexture" : creates
PairWiseIntegrationTest *-- "mockPiece" : creates

' Test validates Real classes
PairWiseIntegrationTest ..> BoardManager : <<tests>>
PairWiseIntegrationTest ..> PieceManager : <<tests>>
PairWiseIntegrationTest ..> GameManager : <<tests>>
PairWiseIntegrationTest ..> PieceColors : <<tests>>
PairWiseIntegrationTest ..> PieceDirections : <<tests>>
PairWiseIntegrationTest ..> PieceClass : <<tests>>

' Mocks simulate Real classes
"mockBoardManager" ..|> BoardManager : <<simulates>>
"mockPieceManager" ..|> PieceManager : <<simulates>>

' Test Structure Notes
note right of PairWiseIntegrationTest
  <b>Test Structure:</b>
  • 20 integration tests
  • 7 types of mock objects
  • 5+ behaviors per test
  • Setup-Execute-Verify pattern

  <b>Key Features:</b>
  • @ExtendWith(MockitoExtension)
  • @Order for execution sequence
  • @DisplayName for clarity
  • lenient() for optional stubs
end note

note right of "mockBoardManager"
  <b>Mock Configuration Example:</b>
  when(mock.getBoard())
    .thenReturn(mockBoard);

  verify(mock, times(1))
    .getBoard();
end note

note bottom of BoardManager
  <b>Integration Pairs Tested:</b>

  1. GameManager ↔ BoardManager ↔ PieceManager
  2. PieceManager ↔ Piece ↔ BoardManager
  3. PieceManager ↔ PieceColors ↔ PieceDirections
  4. BoardManager ↔ Renderer
  5. BoardManager ↔ Tile System
end note

@enduml
